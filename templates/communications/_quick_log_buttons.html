{% load i18n %}
{% load permissions_tags %}
{# Quick-action buttons for recording contacts â€” appears on client Timeline tab #}
{% has_permission "communication.log" as can_log_comm %}
{% if can_log_comm %}
<div id="quick-log-container" class="quick-log-section">
    <h2>{% trans "Record a Contact" %}</h2>
    <p><small class="secondary">{% trans "Had a call, email, text, or visit? Record it here so it's part of the client file. For clinical notes with engagement and goals, use a Progress Note instead." %}</small></p>
    <div class="quick-log-buttons" role="group" aria-label="{% trans 'Record a contact' %}">
        <button class="outline"
                hx-get="{% url 'communications:quick_log' client_id=client.pk %}?channel=phone"
                hx-target="#quick-log-container"
                hx-swap="innerHTML">
            {% trans "Record a Call" %}
        </button>
        <button class="outline"
                hx-get="{% url 'communications:quick_log' client_id=client.pk %}?channel=sms"
                hx-target="#quick-log-container"
                hx-swap="innerHTML">
            {% trans "Record a Text" %}
        </button>
        <button class="outline"
                hx-get="{% url 'communications:quick_log' client_id=client.pk %}?channel=email"
                hx-target="#quick-log-container"
                hx-swap="innerHTML">
            {% trans "Record an Email" %}
        </button>
        <button class="outline"
                hx-get="{% url 'communications:quick_log' client_id=client.pk %}?channel=in_person"
                hx-target="#quick-log-container"
                hx-swap="innerHTML">
            {% trans "Record a Visit" %}
        </button>
    </div>
    <p><a href="{% url 'communications:communication_log' client_id=client.pk %}" class="secondary" style="font-size: 0.875rem;">{% trans "Detailed contact form" %}</a></p>

    {% if recent_communications %}
    <details style="margin-top: 0.5rem;">
        <summary><small class="secondary">{% trans "Recent" %} ({{ recent_communications|length }})</small></summary>
        {% for comm in recent_communications %}
        {% include "communications/_communication_card.html" with comm=comm compact=True %}
        {% endfor %}
    </details>
    {% endif %}
</div>
{% endif %}
