{% extends "base.html" %}

{% block title %}{{ program.name }} — {{ site.product_name|default:"KoNote" }}{% endblock %}

{% block content %}
<hgroup>
    <h1>
        <span class="program-dot" style="background-color: {{ program.colour_hex }}" aria-hidden="true"></span>
        {{ program.name }}
    </h1>
    <p>{{ program.description }}</p>
</hgroup>

<div role="group">
    <a href="{% url 'programs:program_edit' program_id=program.pk %}" role="button" class="outline">Edit {{ term.program|default:"Program" }}</a>
    <a href="{% url 'programs:program_list' %}" role="button" class="outline secondary">Back to List</a>
</div>

<hr>

<h2>Assigned Staff</h2>

<form hx-post="{% url 'programs:program_add_role' program_id=program.pk %}"
      hx-target="#role-list"
      hx-swap="innerHTML">
    {% csrf_token %}
    <fieldset role="group">
        <select name="user" aria-label="Select user" required>
            <option value="">Choose a user…</option>
            {% for option in role_form.user.field.queryset %}
            <option value="{{ option.pk }}">{{ option.display_name }}</option>
            {% endfor %}
        </select>
        <select name="role" aria-label="Select role" required>
            {% for value, label in role_form.role.field.choices %}
            <option value="{{ value }}">{{ label }}</option>
            {% endfor %}
        </select>
        <button type="submit">Add</button>
    </fieldset>
</form>

<div id="role-list" aria-live="polite">
    {% include "programs/_role_list.html" %}
</div>
{% endblock %}
