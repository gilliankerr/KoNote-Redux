{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Help" %} - {{ site.product_name|default:"KoNote2" }}{% endblock %}

{% block content %}
<div class="help-page">
    <h1>{% trans "KoNote2 Help" %}</h1>

    <p>{% trans "Welcome to KoNote2! This guide helps you find what you need quickly." %}</p>

    <!-- Quick Navigation -->
    <nav class="help-nav" aria-label="{% trans 'Help navigation' %}">
        <h2>{% trans "Quick Navigation" %}</h2>
        <ul>
            <li><a href="#getting-started">{% trans "Getting Started" %}</a></li>
            <li><a href="#searching">{% blocktrans with clients=term.client_plural|default:"Participants" %}Searching for {{ clients }}{% endblocktrans %}</a></li>
            <li><a href="#files">{% blocktrans with client=term.client|default:"Participant" file=term.file|default:"File" %}{{ client }} {{ file }}s{% endblocktrans %}</a></li>
            <li><a href="#notes">{{ term.progress_note_plural }}</a></li>
            <li><a href="#events">{% trans "Events and Alerts" %}</a></li>
            <li><a href="#plans">{{ term.plan }}s</a></li>
            <li><a href="#reports">{% trans "Analysis and Reports" %}</a></li>
            <li><a href="#roles">{% trans "Roles" %}</a></li>
            <li><a href="#shortcuts">{% trans "Keyboard Shortcuts" %}</a></li>
            <li><a href="#troubleshooting">{% trans "Troubleshooting" %}</a></li>
            {% if user.is_admin %}
            <li><a href="#admin">{% trans "Administrator Tasks" %}</a></li>
            {% endif %}
        </ul>
    </nav>

    <!-- Getting Started -->
    <section id="getting-started">
        <h2>{% trans "Getting Started" %}</h2>

        <h3>{% trans "The Home Page" %}</h3>
        <p>{% trans "After logging in, your home page shows:" %}</p>
        <table>
            <thead>
                <tr>
                    <th scope="col">{% trans "Section" %}</th>
                    <th scope="col">{% trans "What It Shows" %}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>{% trans "Search bar" %}</strong></td>
                    <td>{% blocktrans with clients=term.client_plural|default:"Participants" %}Type a name or ID to find {{ clients }}{% endblocktrans %}</td>
                </tr>
                <tr>
                    <td><strong>{% trans "Stats row" %}</strong></td>
                    <td>{% blocktrans with clients=term.client_plural|default:"Participants" %}Active {{ clients }}, alerts, {{ clients }} needing attention{% endblocktrans %}</td>
                </tr>
                <tr>
                    <td><strong>{% trans "Priority Items" %}</strong></td>
                    <td>{% blocktrans with clients=term.client_plural|default:"Participants" %}{{ clients }} with active alerts or no recent notes{% endblocktrans %}</td>
                </tr>
                <tr>
                    <td><strong>{% trans "Recently Viewed" %}</strong></td>
                    <td>{% blocktrans with clients=term.client_plural|default:"Participants" %}Quick links to {{ clients }} you've looked at recently{% endblocktrans %}</td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- Searching for Clients -->
    <section id="searching">
        <h2>{% blocktrans with clients=term.client_plural|default:"Participants" %}Searching for {{ clients }}{% endblocktrans %}</h2>

        <h3>{% trans "Quick Search" %}</h3>
        <ol>
            <li>{% blocktrans with client=term.client|default:"Participant" %}Type a {{ client }}'s name or record ID in the search bar{% endblocktrans %}</li>
            <li>{% trans "Results appear as you type" %}</li>
            <li>{% blocktrans with file=term.file|default:"File" %}Click a name to open their {{ file }}{% endblocktrans %}</li>
        </ol>

        <h3>{% trans "Using Filters" %}</h3>
        <ol>
            <li>{% trans "Click" %} <strong>{% trans "Search filters" %}</strong> {% trans "below the search bar" %}</li>
            <li>{% trans "Choose from:" %}
                <ul>
                    <li><strong>{% trans "Status" %}</strong> — {% trans "Active, Inactive, or Discharged" %}</li>
                    {% if features.programs %}
                    <li><strong>{{ term.program|capfirst }}</strong> — {% blocktrans with prog=term.program|default:"programme" %}Filter by specific {{ prog }}{% endblocktrans %}</li>
                    {% endif %}
                    <li><strong>{% trans "Date range" %}</strong> — {% trans "Created after/before certain dates" %}</li>
                </ul>
            </li>
            <li>{% trans "Results update automatically" %}</li>
        </ol>
    </section>

    <!-- Client Files -->
    <section id="files">
        <h2>{% blocktrans with client=term.client|default:"Participant" file=term.file|default:"File" %}{{ client }} {{ file }}s{% endblocktrans %}</h2>

        <p>{% blocktrans with client=term.client|default:"Participant" file=term.file|default:"File" %}When you open a {{ client }}'s {{ file }}, you'll see several tabs:{% endblocktrans %}</p>

        <table>
            <thead>
                <tr>
                    <th scope="col">{% trans "Tab" %}</th>
                    <th scope="col">{% trans "What You'll Find" %}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>{% trans "Info" %}</strong></td>
                    <td>{% trans "Basic information," %} {% if features.programs %}{% blocktrans with prog=term.program|default:"programme" %}{{ prog }} enrolments,{% endblocktrans %}{% endif %} {% trans "custom fields" %}</td>
                </tr>
                <tr>
                    <td><strong>{% trans "Notes" %}</strong></td>
                    <td>{% blocktrans with notes=term.progress_note_plural|default:"Progress Notes" %}{{ notes }} timeline{% endblocktrans %}</td>
                </tr>
                <tr>
                    <td><strong>{{ term.plan|capfirst }}</strong></td>
                    <td>{% blocktrans with plan=term.plan|default:"Plan" sections=term.section|default:"Section" targets=term.target_plural|default:"Targets" metrics=term.metric_plural|default:"Metrics" %}{{ plan }} with {{ sections }}s, {{ targets }}, and {{ metrics }}{% endblocktrans %}</td>
                </tr>
                <tr>
                    <td><strong>{% trans "Events" %}</strong></td>
                    <td>{% trans "Events and alerts" %}</td>
                </tr>
                <tr>
                    <td><strong>{% trans "Analysis" %}</strong></td>
                    <td>{% trans "Progress charts over time" %}</td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- Progress Notes -->
    <section id="notes">
        <h2>{{ term.progress_note_plural|capfirst }}</h2>

        <p>{% blocktrans with notes=term.progress_note_plural|default:"Progress Notes" clients=term.client_plural|default:"Participants" %}{{ notes }} document your interactions with {{ clients }}. KoNote2 offers two types:{% endblocktrans %}</p>

        <h3>{{ term.quick_note|capfirst }}s</h3>
        <p>{% blocktrans with qnotes=term.quick_note|default:"Quick Note" %}Use {{ qnotes }}s for brief check-ins or short updates.{% endblocktrans %}</p>
        <ol>
            <li>{% blocktrans with client=term.client|default:"Participant" file=term.file|default:"File" %}Open the {{ client }}'s {{ file }}{% endblocktrans %}</li>
            <li>{% trans "Go to the" %} <strong>{% trans "Notes" %}</strong> {% trans "tab" %}</li>
            <li>{% trans "Click" %} <strong>+ {{ term.quick_note|capfirst }}</strong></li>
            <li>{% trans "Type your note" %}</li>
            <li>{% trans "Click" %} <strong>{% trans "Save" %}</strong></li>
        </ol>

        <h3>{% blocktrans with notes=term.progress_note_plural|default:"Progress Notes" %}Full {{ notes }}{% endblocktrans %}</h3>
        <p>{% blocktrans with notes=term.progress_note_plural|default:"Progress Notes" plan=term.plan|default:"Plan" targets=term.target_plural|default:"Targets" %}Use full {{ notes }} for structured sessions where you're working on {{ plan }} {{ targets }}.{% endblocktrans %}</p>
        <ol>
            <li>{% blocktrans with client=term.client|default:"Participant" file=term.file|default:"File" %}Open the {{ client }}'s {{ file }}{% endblocktrans %}</li>
            <li>{% trans "Go to the" %} <strong>{% trans "Notes" %}</strong> {% trans "tab" %}</li>
            <li>{% trans "Click" %} <strong>+ {{ term.progress_note|capfirst }}</strong></li>
            <li>{% trans "Fill in:" %}
                <ul>
                    <li><strong>{% trans "Session date" %}</strong> — {% trans "defaults to today" %}</li>
                    <li><strong>{% trans "Summary" %}</strong> — {% trans "brief overview of the session" %}</li>
                    <li><strong>{{ term.target|capfirst }} {{ term.section }}s</strong> — {% blocktrans with metric=term.metric|default:"Metric" target=term.target|default:"Target" %}notes and {{ metric }} values for each {{ target }} you worked on{% endblocktrans %}</li>
                </ul>
            </li>
            <li>{% trans "Click" %} <strong>{% trans "Save Note" %}</strong></li>
        </ol>

        <p><strong>{% trans "Tip:" %}</strong> {% blocktrans with targets=term.target_plural|default:"Targets" %}You only need to fill in the {{ targets }} you actually worked on. Leave others blank.{% endblocktrans %}</p>

        <h3>{% blocktrans with metrics=term.metric_plural|default:"Metrics" %}Recording {{ metrics }}{% endblocktrans %}</h3>
        <p>{% blocktrans with note=term.progress_note|default:"Progress Note" metric=term.metric|default:"Metric" target=term.target|default:"Target" %}When writing a full {{ note }}, you'll see {{ metric }} fields under each {{ target }}. Common types:{% endblocktrans %}</p>
        <ul>
            <li><strong>{% trans "Scale ratings" %}</strong> (1–10) {% trans "for things like housing stability or mood" %}</li>
            <li><strong>{% trans "Yes/No" %}</strong> {% trans "checkboxes for milestone achievements" %}</li>
            <li><strong>{% trans "Text" %}</strong> {% trans "for qualitative observations" %}</li>
        </ul>

        <h3>{% trans "Backdating Notes" %}</h3>
        <p>{% trans "Documenting a session that happened earlier? In the note form, change the" %} <strong>{% trans "Session date" %}</strong> {% trans "to the actual date. The note will appear in the timeline based on that date." %}</p>

        <h3>{% trans "Cancelling a Note" %}</h3>
        <p>{% trans "Made a mistake? You can cancel a note within 24 hours:" %}</p>
        <ol>
            <li>{% trans "Find the note in the Notes tab" %}</li>
            <li>{% trans "Click" %} <strong>{% trans "Cancel" %}</strong></li>
            <li>{% trans "Enter a reason (required)" %}</li>
            <li>{% trans "Confirm" %}</li>
        </ol>
        <p>{% trans "The note remains visible but is marked as cancelled. After 24 hours, notes cannot be cancelled." %}</p>
    </section>

    <!-- Events and Alerts -->
    <section id="events">
        <h2>{% trans "Events and Alerts" %}</h2>

        <h3>{% trans "Events" %}</h3>
        <p>{% trans "Events record discrete occurrences that don't need a full note — intake, discharge, hospital visits, crises, etc." %}</p>
        <ol>
            <li>{% blocktrans with client=term.client|default:"Participant" file=term.file|default:"File" %}Open the {{ client }}'s {{ file }}{% endblocktrans %}</li>
            <li>{% trans "Go to the" %} <strong>{% trans "Events" %}</strong> {% trans "tab" %}</li>
            <li>{% trans "Click" %} <strong>+ {% trans "New Event" %}</strong></li>
            <li>{% trans "Choose the event type" %}</li>
            <li>{% trans "Enter the date" %}</li>
            <li>{% trans "Add any notes" %}</li>
            <li>{% trans "Click" %} <strong>{% trans "Save" %}</strong></li>
        </ol>

        <h3>{{ term.alert|capfirst }}s</h3>
        <p>{% blocktrans with alerts=term.alert|default:"Alert" client=term.client|default:"Participant" %}{{ alerts }}s flag a {{ client }} as needing attention. Use them for safety concerns or urgent follow-ups.{% endblocktrans %}</p>
        <ol>
            <li>{% blocktrans with client=term.client|default:"Participant" file=term.file|default:"File" %}Open the {{ client }}'s {{ file }}{% endblocktrans %}</li>
            <li>{% trans "Go to the" %} <strong>{% trans "Events" %}</strong> {% trans "tab" %}</li>
            <li>{% trans "Click" %} <strong>+ {% trans "New" %} {{ term.alert|capfirst }}</strong></li>
            <li>{% trans "Describe the concern" %}</li>
            <li>{% trans "Click" %} <strong>{% trans "Save" %}</strong></li>
        </ol>
        <p>{% blocktrans with client=term.client|default:"Participant" %}The {{ client }} will appear in Priority Items on the home page until the alert is resolved.{% endblocktrans %}</p>

        <h3>{% blocktrans with alerts=term.alert|default:"Alert" %}Resolving {{ alerts }}s{% endblocktrans %}</h3>
        <ol>
            <li>{% blocktrans with alert=term.alert|default:"Alert" %}Find the {{ alert }} in the Events tab{% endblocktrans %}</li>
            <li>{% trans "Click" %} <strong>{% trans "Resolve" %}</strong> {% trans "or" %} <strong>{% trans "Cancel" %} {{ term.alert|capfirst }}</strong></li>
            <li>{% trans "Add a resolution note" %}</li>
            <li>{% trans "Save" %}</li>
        </ol>
    </section>

    <!-- Outcome Plans -->
    <section id="plans">
        <h2>{{ term.plan|capfirst }}s</h2>

        <p>{% blocktrans with plan=term.plan|default:"Plan" client=term.client|default:"Participant" %}The {{ plan }} tab shows the {{ client }}'s {{ plan }} — their goals and how they're progressing.{% endblocktrans %}</p>

        <h3>{% blocktrans with plan=term.plan|default:"Plan" %}Understanding the {{ plan }} Structure{% endblocktrans %}</h3>
        <ul>
            <li><strong>{{ term.section|capfirst }}s</strong> — {% trans "Broad categories like" %} "{% trans "Housing" %}", "{% trans "Employment" %}", "{% trans "Health" %}"</li>
            <li><strong>{{ term.target_plural|capfirst }}</strong> — {% blocktrans with section=term.section|default:"Section" %}Specific goals within each {{ section }}{% endblocktrans %}</li>
            <li><strong>{{ term.metric_plural|capfirst }}</strong> — {% blocktrans with targets=term.target_plural|default:"Targets" %}Measurable indicators attached to {{ targets }}{% endblocktrans %}</li>
        </ul>

        <h3>{% blocktrans with target=term.target|default:"Target" %}Viewing {{ target }} Details{% endblocktrans %}</h3>
        <ol>
            <li>{% blocktrans with target=term.target|default:"Target" %}Click a {{ target }} name to expand it{% endblocktrans %}</li>
            <li>{% blocktrans with metric=term.metric|default:"Metric" target=term.target|default:"Target" %}View all notes and {{ metric }} recordings for that {{ target }}{% endblocktrans %}</li>
            <li>{% blocktrans with metrics=term.metric_plural|default:"Metrics" %}See progress charts (if {{ metrics }} have been recorded){% endblocktrans %}</li>
        </ol>

        <h3>{% blocktrans with plans=term.plan|default:"Plan" %}Editing {{ plans }}s{% endblocktrans %}</h3>
        <p>{% blocktrans with plans=term.plan|default:"Plan" %}<strong>Staff</strong> can view {{ plans }}s but typically cannot edit them.{% endblocktrans %}</p>
        <p>{% blocktrans with sections=term.section|default:"Section" targets=term.target_plural|default:"Targets" metrics=term.metric_plural|default:"Metrics" %}<strong>Program managers</strong> and <strong>coordinators</strong> can add {{ sections }}s, {{ targets }}, and assign {{ metrics }}.{% endblocktrans %}</p>
    </section>

    <!-- Analysis and Reports -->
    <section id="reports">
        <h2>{% trans "Analysis and Reports" %}</h2>

        <h3>{% trans "Viewing Progress Charts" %}</h3>
        <ol>
            <li>{% blocktrans with client=term.client|default:"Participant" file=term.file|default:"File" %}Open the {{ client }}'s {{ file }}{% endblocktrans %}</li>
            <li>{% trans "Go to the" %} <strong>{% trans "Analysis" %}</strong> {% trans "tab" %}</li>
            <li>{% blocktrans with metric=term.metric|default:"Metric" %}View charts showing {{ metric }} values over time{% endblocktrans %}</li>
        </ol>
        <p>{% blocktrans with metric=term.metric|default:"Metric" notes=term.progress_note_plural|default:"Progress Notes" %}Charts automatically update when new {{ metric }} values are recorded in {{ notes }}.{% endblocktrans %}</p>

        <h3>{% trans "Exporting Data" %}</h3>
        <p><strong>{% trans "Program managers and administrators" %}</strong> {% trans "can export data:" %}</p>
        <ul>
            <li><strong>{% trans "Metric Export (CSV)" %}</strong> — {% blocktrans with metric=term.metric|default:"Metric" prog=term.program|default:"Programme" metrics=term.metric_plural|default:"Metrics" %}Export {{ metric }} data filtered by {{ prog }}, {{ metrics }}, and date range{% endblocktrans %}</li>
            <li><strong>{% blocktrans with client=term.client|default:"Participant" %}{{ client }} Data Export{% endblocktrans %}</strong> — {% blocktrans with client=term.client|default:"Participant" %}Download a {{ client }}'s complete data (for GDPR/privacy requests){% endblocktrans %}</li>
            <li><strong>{% trans "PDF Reports" %}</strong> — {% trans "Generate printable progress reports" %}</li>
        </ul>
        <p>{% trans "Find export options under" %} <strong>{% trans "Reports" %}</strong> {% trans "in the main navigation." %}</p>
    </section>

    <!-- Keyboard Shortcuts -->
    <section id="shortcuts">
        <h2>{% trans "Keyboard Shortcuts" %}</h2>

        <p>{% trans "Speed up your work with these shortcuts:" %}</p>

        <table>
            <thead>
                <tr>
                    <th scope="col">{% trans "Shortcut" %}</th>
                    <th scope="col">{% trans "Action" %}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><kbd>/</kbd></td>
                    <td>{% trans "Focus the search bar" %}</td>
                </tr>
                <tr>
                    <td><kbd>g</kbd> {% trans "then" %} <kbd>h</kbd></td>
                    <td>{% trans "Go to Home" %}</td>
                </tr>
                <tr>
                    <td><kbd>n</kbd></td>
                    <td>{% blocktrans with qnote=term.quick_note|default:"Quick Note" client=term.client|default:"Participant" %}New {{ qnote }} (on {{ client }} page){% endblocktrans %}</td>
                </tr>
                <tr>
                    <td><kbd>Ctrl</kbd>+<kbd>S</kbd></td>
                    <td>{% trans "Save current form" %}</td>
                </tr>
                <tr>
                    <td><kbd>Esc</kbd></td>
                    <td>{% trans "Close modal or cancel action" %}</td>
                </tr>
                <tr>
                    <td><kbd>?</kbd></td>
                    <td>{% trans "Show keyboard shortcuts" %}</td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- Understanding Roles -->
    <section id="roles">
        <h2>{% trans "Understanding Roles" %}</h2>

        <p>{% trans "Your access depends on your assigned role:" %}</p>

        <table>
            <thead>
                <tr>
                    <th scope="col">{% trans "Role" %}</th>
                    <th scope="col">{% trans "What You Can Do" %}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>{% trans "Front Desk" %}</strong></td>
                    <td>{% blocktrans with client=term.client|default:"Participant" %}View limited {{ client }} info, update contact details{% endblocktrans %}</td>
                </tr>
                <tr>
                    <td><strong>{% trans "Staff" %}</strong></td>
                    <td>{% blocktrans with client=term.client|default:"Participant" %}Full {{ client }} access, write notes, record events{% endblocktrans %}</td>
                </tr>
                <tr>
                    <td><strong>{% trans "Program Manager" %}</strong></td>
                    <td>{% blocktrans with plans=term.plan|default:"Plan" %}All staff abilities plus edit {{ plans }}s, manage team{% endblocktrans %}</td>
                </tr>
                <tr>
                    <td><strong>{% trans "Administrator" %}</strong></td>
                    <td>{% trans "System settings, user management, all configuration" %}</td>
                </tr>
            </tbody>
        </table>

        <p><strong>{% trans "Note:" %}</strong> {% blocktrans with prog=term.program|default:"Programme" client=term.client|default:"Participant" %}Administrators without a {{ prog }} assignment cannot see {{ client }} data. This is a security feature.{% endblocktrans %}</p>

        <h3>{% trans "Different Roles in Different Programs" %}</h3>
        <p>{% blocktrans with prog=term.program|default:"Programme" %}You may have a different role depending on which {{ prog }} you are working in. For example, you might be a Program Manager in one {{ prog }} and Direct Service staff in another.{% endblocktrans %}</p>
        <p>{% blocktrans with progs=term.program_plural|default:"Programmes" prog=term.program|default:"Programme" %}Your current role is shown as a badge next to your name in the navigation bar. If you switch {{ progs }}, the badge updates to reflect your role in that {{ prog }}.{% endblocktrans %}</p>
    </section>

    {% if user.is_admin %}
    <!-- Administrator Tasks -->
    <section id="admin">
        <h2>{% trans "Administrator Tasks" %}</h2>

        <p>{% trans "As an administrator, you can configure KoNote2 through the" %} <strong>{% trans "Admin" %}</strong> {% trans "menu:" %}</p>

        <table>
            <thead>
                <tr>
                    <th scope="col">{% trans "Task" %}</th>
                    <th scope="col">{% trans "Where to Find It" %}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>{% trans "Create users" %}</td>
                    <td>{% trans "Admin" %} → {% trans "Invites" %}</td>
                </tr>
                {% if features.programs %}
                <tr>
                    <td>{% blocktrans with progs=term.program_plural|default:"Programmes" %}Manage {{ progs }}{% endblocktrans %}</td>
                    <td>{% trans "Admin" %} → {{ term.program_plural|capfirst }}</td>
                </tr>
                {% endif %}
                <tr>
                    <td>{% blocktrans with metrics=term.metric_plural|default:"Metrics" %}Set up {{ metrics }}{% endblocktrans %}</td>
                    <td>{% trans "Admin" %} → {{ term.metric_plural|capfirst }}</td>
                </tr>
                <tr>
                    <td>{% blocktrans with plan=term.plan|default:"Plan" %}Create {{ plan }} templates{% endblocktrans %}</td>
                    <td>{% trans "Admin" %} → {% trans "Templates" %}</td>
                </tr>
                <tr>
                    <td>{% trans "Customise terminology" %}</td>
                    <td>{% trans "Admin" %} → {% trans "Settings" %} → {% trans "Terminology" %}</td>
                </tr>
                <tr>
                    <td>{% trans "Enable/disable features" %}</td>
                    <td>{% trans "Admin" %} → {% trans "Settings" %} → {% trans "Features" %}</td>
                </tr>
                <tr>
                    <td>{% trans "View audit logs" %}</td>
                    <td>{% trans "Admin" %} → {% trans "Audit Log" %}</td>
                </tr>
                <tr>
                    <td>{% trans "Registration links" %}</td>
                    <td>{% trans "Admin" %} → {% trans "Registration" %}</td>
                </tr>
            </tbody>
        </table>

        <p>{% trans "Need help with a setting? Contact your system administrator or support team." %}</p>
    </section>
    {% endif %}

    <!-- Troubleshooting -->
    <section id="troubleshooting">
        <h2>{% trans "Troubleshooting" %}</h2>

        <h3>{% trans "I can't log in" %}</h3>
        <p><strong>{% trans "Azure AD:" %}</strong> {% trans "Check that your work email is registered with KoNote2. Contact your administrator." %}</p>
        <p><strong>{% trans "Local login:" %}</strong> {% trans "Confirm your credentials. If forgotten, ask your administrator to reset your password." %}</p>

        <h3>{% blocktrans with client=term.client|default:"Participant" %}I can't find a {{ client }}{% endblocktrans %}</h3>
        <ul>
            <li>{% trans "Check your spelling" %}</li>
            <li>{% trans "Try searching by record ID instead of name" %}</li>
            <li>{% trans "Check filters — you may have a status filter active" %}</li>
            <li>{% blocktrans with clients=term.client_plural|default:"Participants" progs=term.program_plural|default:"Programmes" %}You can only see {{ clients }} in {{ progs }} you're assigned to{% endblocktrans %}</li>
        </ul>

        <h3>{% blocktrans with client=term.client|default:"Participant" plan=term.plan|default:"Plan" %}I can't edit a {{ client }}'s {{ plan }}{% endblocktrans %}</h3>
        <p>{% blocktrans with plans=term.plan|default:"Plan" %}Only program managers and administrators can edit {{ plans }}s. If you need changes, let your supervisor know.{% endblocktrans %}</p>

        <h3>{% trans "I can't see the Admin menu" %}</h3>
        <p>{% trans "The Admin menu only appears for administrators. If you need admin access, contact your system administrator." %}</p>

        <h3>{% trans "My changes aren't saving" %}</h3>
        <ul>
            <li>{% trans "Check for validation errors (red text near fields)" %}</li>
            <li>{% trans "Ensure you're clicking" %} <strong>{% trans "Save" %}</strong>{% trans ", not just closing the form" %}</li>
            <li>{% trans "Try refreshing the page and attempting again" %}</li>
        </ul>

        <h3>{% trans "Charts aren't showing data" %}</h3>
        <p>{% blocktrans with metric=term.metric|default:"Metric" notes=term.progress_note_plural|default:"Progress Notes" metrics=term.metric_plural|default:"Metrics" target=term.target|default:"Target" %}Charts require {{ metric }} values recorded in {{ notes }}. If no {{ metrics }} have been recorded for a {{ target }}, charts will be empty.{% endblocktrans %}</p>

        <h3>{% trans "The page timed out" %}</h3>
        <p>{% trans "For security, KoNote2 logs you out after inactivity. Log in again to continue. Your unsaved work may be lost." %}</p>
    </section>

    <!-- Getting More Help -->
    <section id="more-help">
        <h2>{% trans "Getting More Help" %}</h2>

        <h3>{% trans "In-App Resources" %}</h3>
        <ul>
            <li>{% trans "Press" %} <kbd>?</kbd> {% trans "anywhere in the app to see keyboard shortcuts" %}</li>
        </ul>

        <h3>{% trans "Contact Support" %}</h3>
        <ul>
            <li><strong>{% trans "Password issues" %}</strong> — {% trans "Contact your supervisor or administrator" %}</li>
            <li><strong>{% trans "Bug reports" %}</strong> — {% trans "Report to your administrator" %}</li>
            <li><strong>{% trans "Feature requests" %}</strong> — {% trans "Talk to your program coordinator" %}</li>
        </ul>
        {% if site.support_email %}
        <p>{% trans "Support email:" %} <a href="mailto:{{ site.support_email }}">{{ site.support_email }}</a></p>
        {% endif %}
    </section>

    <!-- Quick Reference -->
    <section id="quick-ref">
        <h2>{% trans "Quick Reference" %}</h2>

        <h3>{% trans "Common Tasks" %}</h3>
        <table>
            <thead>
                <tr>
                    <th scope="col">{% trans "I want to..." %}</th>
                    <th scope="col">{% trans "Do this..." %}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>{% blocktrans with client=term.client|default:"Participant" %}Find a {{ client }}{% endblocktrans %}</td>
                    <td>{% trans "Type name in search bar" %}</td>
                </tr>
                <tr>
                    <td>{% trans "Write a quick update" %}</td>
                    <td>{% trans "Notes tab" %} → + {{ term.quick_note|capfirst }}</td>
                </tr>
                <tr>
                    <td>{% trans "Document a session" %}</td>
                    <td>{% trans "Notes tab" %} → + {{ term.progress_note|capfirst }}</td>
                </tr>
                <tr>
                    <td>{% trans "Record intake/discharge" %}</td>
                    <td>{% trans "Events tab" %} → + {% trans "New Event" %}</td>
                </tr>
                <tr>
                    <td>{% trans "Flag a safety concern" %}</td>
                    <td>{% trans "Events tab" %} → + {% trans "New" %} {{ term.alert|capfirst }}</td>
                </tr>
                <tr>
                    <td>{% trans "See who needs attention" %}</td>
                    <td>{% trans "Check Priority Items on home page" %}</td>
                </tr>
                <tr>
                    <td>{% trans "View progress charts" %}</td>
                    <td>{% blocktrans with client=term.client|default:"Participant" file=term.file|default:"File" %}{{ client }} {{ file }}{% endblocktrans %} → {% trans "Analysis tab" %}</td>
                </tr>
            </tbody>
        </table>

        <h3>{% trans "Understanding Status" %}</h3>
        <table>
            <thead>
                <tr>
                    <th scope="col">{% blocktrans with client=term.client|default:"Participant" %}{{ client }} Status{% endblocktrans %}</th>
                    <th scope="col">{% trans "Meaning" %}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>{% trans "Active" %}</strong></td>
                    <td>{% trans "Currently receiving services" %}</td>
                </tr>
                <tr>
                    <td><strong>{% trans "Inactive" %}</strong></td>
                    <td>{% trans "Temporarily not receiving services" %}</td>
                </tr>
                <tr>
                    <td><strong>{% trans "Discharged" %}</strong></td>
                    <td>{% trans "Services completed or ended" %}</td>
                </tr>
            </tbody>
        </table>
    </section>

</div>

<style>
.help-page {
    max-width: 900px;
    margin: 0 auto;
    padding: 2rem 1rem;
}

.help-nav {
    background: var(--pico-card-background-color, #f5f5f5);
    padding: 1.5rem;
    border-radius: 8px;
    margin-bottom: 2rem;
}

.help-nav h2 {
    margin-top: 0;
    font-size: 1.1rem;
}

.help-nav ul {
    columns: 2;
    margin-bottom: 0;
}

@media (max-width: 600px) {
    .help-nav ul {
        columns: 1;
    }
}

.help-page section {
    margin-bottom: 3rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid var(--pico-muted-border-color, #e0e0e0);
}

.help-page section:last-child {
    border-bottom: none;
}

.help-page h2 {
    color: var(--pico-primary, #1976d2);
    border-bottom: 2px solid var(--pico-primary, #1976d2);
    padding-bottom: 0.5rem;
}

.help-page h3 {
    margin-top: 1.5rem;
    color: var(--pico-secondary, #607d8b);
}

.help-page table {
    margin: 1rem 0;
}

.help-page kbd {
    background: var(--pico-muted-background-color, #e0e0e0);
    border: 1px solid var(--pico-muted-border-color, #ccc);
    border-radius: 4px;
    padding: 0.15rem 0.4rem;
    font-family: monospace;
    font-size: 0.9em;
}

.help-page ol, .help-page ul {
    margin-left: 1.5rem;
}

.help-page li {
    margin-bottom: 0.5rem;
}

@media print {
    .help-nav {
        break-inside: avoid;
    }
    .help-page section {
        break-inside: avoid;
    }
}
</style>
{% endblock %}
