{% load i18n %}
<header>
    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 0.5rem;">
        <h2 style="margin: 0;" id="section-heading-{{ section.pk }}">
            {{ section.name }}
            {% if section.status == "default" %}
                <span class="badge badge-success">{% trans "Active" %}</span>
            {% elif section.status == "completed" %}
                <span class="badge badge-info">{% trans "Completed" %}</span>
            {% else %}
                <span class="badge badge-neutral">{% trans "Deactivated" %}</span>
            {% endif %}
        </h2>
        {% if can_edit %}
        <div role="group">
            <button class="outline small"
                    hx-get="{% url 'plans:section_edit' section_id=section.pk %}"
                    hx-target="#section-{{ section.pk }}"
                    hx-swap="innerHTML"
                    aria-label="{% blocktrans with name=section.name %}Edit {{ name }}{% endblocktrans %}">
                {% trans "Edit" %}
            </button>
            <button class="outline small secondary"
                    hx-get="{% url 'plans:section_status' section_id=section.pk %}"
                    hx-target="#section-{{ section.pk }}"
                    hx-swap="innerHTML"
                    hx-confirm="{% trans 'Change the status of this section? This may affect related targets.' %}"
                    aria-label="{% blocktrans with name=section.name %}Change status of {{ name }}{% endblocktrans %}">
                {% trans "Status" %}
            </button>
        </div>
        {% endif %}
    </div>
    {% if section.program and not hide_program_dot %}
    <small>
        <span class="program-dot" style="background-color: {{ section.program.colour_hex }}" aria-hidden="true"></span>
        {{ section.program.translated_name }}
    </small>
    {% endif %}
</header>

<!-- Targets within this section -->
{% if section.targets.all %}
<table role="grid" aria-labelledby="section-heading-{{ section.pk }}">
    <thead>
        <tr>
            <th scope="col">{{ term.target|default:"Target" }}</th>
            <th scope="col">{% trans "Status" %}</th>
            <th scope="col">{{ term.metric_plural|default:"Metrics" }}</th>
            {% if can_edit %}<th scope="col">{% trans "Actions" %}</th>{% endif %}
        </tr>
    </thead>
    <tbody>
        {% for target in section.targets.all %}
        <tr id="target-{{ target.pk }}">
            {% include "plans/_target.html" with target=target can_edit=can_edit %}
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p><em>{% blocktrans with targets=term.target_plural|default:"targets" section=term.section|default:"section" %}No {{ targets }} in this {{ section }}.{% endblocktrans %}</em></p>
{% endif %}

{% if can_edit and active_service_model != "group" %}
<footer>
    <a href="{% url 'plans:target_create' section_id=section.pk %}" role="button" class="outline small">
        {% blocktrans with target=term.target|default:"Target" %}Add {{ target }}{% endblocktrans %}
    </a>
</footer>
{% endif %}
