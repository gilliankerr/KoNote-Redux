{% extends "base.html" %}
{% load i18n %}

{% block title %}{% if editing %}{% blocktrans with group=term.group|default:"Group" %}Edit {{ group }}{% endblocktrans %}{% else %}{% blocktrans with group=term.group|default:"Group" %}Add {{ group }}{% endblocktrans %}{% endif %} — {{ site.product_name|default:"KoNote2" }}{% endblock %}

{% block content %}
<hgroup>
    <h1>{% if editing %}{% blocktrans with name=group.name %}Edit {{ name }}{% endblocktrans %}{% else %}{% blocktrans with group=term.group|default:"Group" %}Add {{ group }}{% endblocktrans %}{% endif %}</h1>
</hgroup>

<form method="post">
    {% csrf_token %}

    {# Group type — radio buttons with descriptions #}
    <fieldset>
        <legend><strong>{% trans "What type of group is this?" %}</strong></legend>
        {% for radio in form.group_type %}
        <label style="display: flex; align-items: flex-start; gap: 0.5rem; margin-bottom: 0.5rem;">
            <input type="radio" name="{{ form.group_type.html_name }}" value="{{ radio.choice_value }}"
                   {% if radio.is_checked %}checked{% endif %}
                   style="margin-top: 0.25rem;">
            <span>
                {{ radio.choice_label }}
                {% if radio.choice_value == "group" %}
                <br><small class="secondary">{% trans "Attendance tracking and session notes." %}</small>
                {% elif radio.choice_value == "project" %}
                <br><small class="secondary">{% trans "Milestones, outcomes, and deadlines." %}</small>
                {% endif %}
            </span>
        </label>
        {% endfor %}
        {% if form.group_type.errors %}
        <small class="badge badge-danger">{{ form.group_type.errors.0 }}</small>
        {% endif %}
    </fieldset>

    {# Remaining fields (name, program, description) #}
    {% for field in form %}
    {% if field.name != "group_type" %}
    <label for="{{ field.id_for_label }}">
        {{ field.label }}
        {% if field.field.required %}<abbr title="{% trans 'required' %}">*</abbr>{% endif %}
    </label>
    {{ field }}
    {% if field.help_text %}
    <small>{{ field.help_text }}</small>
    {% endif %}
    {% if field.errors %}
    <small class="badge badge-danger">{{ field.errors.0 }}</small>
    {% endif %}
    {% endif %}
    {% endfor %}

    <div role="group">
        <button type="submit">{% if editing %}{% trans "Save Changes" %}{% else %}{% blocktrans with group=term.group|default:"Group" %}Create {{ group }}{% endblocktrans %}{% endif %}</button>
        {% if editing %}
        <a href="{% url 'groups:group_detail' group_id=group.pk %}" role="button" class="outline">{% trans "Cancel" %}</a>
        {% else %}
        <a href="{% url 'groups:group_list' %}" role="button" class="outline">{% trans "Cancel" %}</a>
        {% endif %}
    </div>
</form>
{% endblock %}
