{% extends "portal/base_portal.html" %}
{% load i18n %}

{% block title %}{% trans "Set New Password" %}{% endblock %}

{# No quick-exit on password reset â€” no sensitive data visible #}
{% block quick_exit %}{% endblock %}

{% block content %}
<article class="portal-login-card">
    <header>
        <h1>{% trans "Set a New Password" %}</h1>
        <p>{% trans "Enter the code from your email and choose a new password." %}</p>
    </header>

    {% if error %}
    <p role="alert" class="portal-alert portal-alert-error">{{ error }}</p>
    {% endif %}

    <form method="post">
        {% csrf_token %}

        <label for="code">{% trans "Reset code" %}</label>
        <input type="text" id="code" name="code"
               inputmode="numeric" pattern="[0-9]{6}" maxlength="6"
               autocomplete="one-time-code" required autofocus
               placeholder="000000"
               aria-describedby="code-help">
        <small id="code-help">{% trans "Enter the 6-digit code we sent to your email." %}</small>
        {% if form.code.errors %}
        <small role="alert" class="portal-field-error">{{ form.code.errors.0 }}</small>
        {% endif %}

        <label for="new-password">{% trans "New password" %}</label>
        <input type="password" id="new-password" name="new_password"
               required
               autocomplete="new-password"
               aria-describedby="new-password-help">
        <small id="new-password-help">{% trans "Choose a strong password. Use at least 8 characters with a mix of letters and numbers." %}</small>
        {% if form.new_password.errors %}
        <small role="alert" class="portal-field-error">{{ form.new_password.errors.0 }}</small>
        {% endif %}

        <label for="new-password-confirm">{% trans "Confirm new password" %}</label>
        <input type="password" id="new-password-confirm" name="new_password_confirm"
               required
               autocomplete="new-password"
               aria-describedby="new-password-confirm-help">
        <small id="new-password-confirm-help">{% trans "Type your new password again to make sure it's right." %}</small>
        {% if form.new_password_confirm.errors %}
        <small role="alert" class="portal-field-error">{{ form.new_password_confirm.errors.0 }}</small>
        {% endif %}

        <button type="submit">{% trans "Set my new password" %}</button>
    </form>

    <p>
        <a href="{% url 'portal:login' %}">&larr; {% trans "Back to sign in" %}</a>
    </p>
</article>
{% endblock %}
